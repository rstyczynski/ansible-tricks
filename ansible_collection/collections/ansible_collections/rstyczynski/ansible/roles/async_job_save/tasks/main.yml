---
# Backend router for async_job_save role
# Routes to appropriate backend implementation based on backend parameter

- name: "Save Job: Validate arguments"
  ansible.builtin.validate_argument_spec:
    argument_spec: "{{ (lookup('file', role_path + '/meta/argument_specs.yml') | from_yaml).argument_specs.main.options }}"

- name: "Save Job: Validate backend parameter"
  ansible.builtin.fail:
    msg: "Invalid backend '{{ async_job_save_backend }}'. Must be 'filesystem' or 'oci'."
  when: async_job_save_backend not in ['filesystem', 'oci']

- name: "Save Job: Route to filesystem backend"
  ansible.builtin.include_tasks: save_filesystem.yml
  when: async_job_save_backend == 'filesystem'

- name: "Save Job: Route to OCI backend"
  ansible.builtin.include_tasks: save_oci.yml
  when: async_job_save_backend == 'oci'
