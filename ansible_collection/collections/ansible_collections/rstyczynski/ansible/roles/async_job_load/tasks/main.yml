---
# Backend router for async_job_load role
# Routes to appropriate backend implementation based on backend parameter

- name: "Load Job: Validate arguments"
  ansible.builtin.validate_argument_spec:
    argument_spec: "{{ (lookup('file', role_path + '/meta/argument_specs.yml') | from_yaml).argument_specs.main.options }}"

- name: "Load Job: Validate backend parameter"
  ansible.builtin.fail:
    msg: "Invalid backend '{{ async_job_load_backend }}'. Must be 'filesystem' or 'oci'."
  when: async_job_load_backend not in ['filesystem', 'oci']

- name: "Load Job: Route to filesystem backend"
  ansible.builtin.include_tasks: load_filesystem.yml
  when: async_job_load_backend == 'filesystem'

- name: "Load Job: Route to OCI backend"
  ansible.builtin.include_tasks: load_oci.yml
  when: async_job_load_backend == 'oci'
